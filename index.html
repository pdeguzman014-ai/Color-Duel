<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grid Collector</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #222;
      color: #fff;
    }
    #grid {
      display: grid;
      grid-template-columns: repeat(10, 40px);
      grid-template-rows: repeat(10, 40px);
      gap: 2px;
      margin: 30px auto;
      width: fit-content;
    }
    .cell {
      width: 40px;
      height: 40px;
      background: #444;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    .p1 { background-color: red; }
    .p2 { background-color: blue; }
    .coin { background-color: gold; }
    .coin::after { content: 'ðŸ’°'; }
    .collected { background-color: #666; }
  </style>
</head>
<body>
<h1>ðŸ’° Grid Collector</h1>
<p>Player 1: W A S D | Player 2: Arrow Keys</p>
<p>First to collect 5 coins wins!</p>
<div style="display: flex; justify-content: center; gap: 40px; margin: 20px;">
  <p>Player 1 Score: <span id="score1">0</span></p>
  <p>Player 2 Score: <span id="score2">0</span></p>
</div>
<div id="grid"></div>
<p id="winner" style="font-size: 24px; margin-top: 20px;"></p>
<button id="playAgain" style="display: none; padding: 10px 20px; font-size: 18px; margin-top: 10px;">Play Again</button>
<script>
  const gridSize = 10;
  const grid = document.getElementById('grid');
  const score1Display = document.getElementById('score1');
  const score2Display = document.getElementById('score2');
  const winnerDisplay = document.getElementById('winner');
  const playAgainBtn = document.getElementById('playAgain');
  
  const state = {
    p1: { x: 0, y: 0, score: 0 },
    p2: { x: 9, y: 9, score: 0 },
    coins: new Set(),
    playing: true,
    winScore: 5
  };
  
  // Create grid
  for (let i = 0; i < gridSize * gridSize; i++) {
    const div = document.createElement('div');
    div.className = 'cell';
    div.dataset.index = i;
    grid.appendChild(div);
  }
  
  function spawnCoins() {
    state.coins.clear();
    // Spawn 8 random coins
    while (state.coins.size < 8) {
      const x = Math.floor(Math.random() * gridSize);
      const y = Math.floor(Math.random() * gridSize);
      const pos = `${x},${y}`;
      // Don't spawn on players
      if ((x !== state.p1.x || y !== state.p1.y) && 
          (x !== state.p2.x || y !== state.p2.y)) {
        state.coins.add(pos);
      }
    }
  }
  
  function drawGrid() {
    document.querySelectorAll('.cell').forEach(cell => {
      cell.className = 'cell';
    });
    
    // Draw coins
    state.coins.forEach(coinPos => {
      const [x, y] = coinPos.split(',').map(Number);
      const idx = y * gridSize + x;
      document.querySelector(`.cell[data-index="${idx}"]`).classList.add('coin');
    });
    
    // Draw players
    const idx1 = state.p1.y * gridSize + state.p1.x;
    const idx2 = state.p2.y * gridSize + state.p2.x;
    document.querySelector(`.cell[data-index="${idx1}"]`).classList.add('p1');
    document.querySelector(`.cell[data-index="${idx2}"]`).classList.add('p2');
    
    // Update scores
    score1Display.textContent = state.p1.score;
    score2Display.textContent = state.p2.score;
  }
  
  function checkCoin(player) {
    const p = state[player];
    const pos = `${p.x},${p.y}`;
    if (state.coins.has(pos)) {
      state.coins.delete(pos);
      p.score++;
      
      // Check win
      if (p.score >= state.winScore) {
        winnerDisplay.textContent = `ðŸŽ‰ ${player.toUpperCase()} wins with ${p.score} coins!`;
        state.playing = false;
        playAgainBtn.style.display = 'inline-block';
        return;
      }
      
      // Spawn new coin if needed
      if (state.coins.size < 3) {
        setTimeout(spawnCoins, 500);
      }
    }
  }
  
  function movePlayer(player, dx, dy) {
    if (!state.playing) return;
    const p = state[player];
    const newX = Math.max(0, Math.min(gridSize - 1, p.x + dx));
    const newY = Math.max(0, Math.min(gridSize - 1, p.y + dy));
    
    // Only move if it's a valid move
    if (newX !== p.x || newY !== p.y) {
      p.x = newX;
      p.y = newY;
      checkCoin(player);
      drawGrid();
    }
  }
  
  // Controls - Real-time movement
  const keys = {};
  document.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;
    keys[e.key] = true;
  });
  
  document.addEventListener('keyup', e => {
    keys[e.key.toLowerCase()] = false;
    keys[e.key] = false;
  });
  
  // Game loop for smooth movement
  function gameLoop() {
    if (!state.playing) return;
    
    // Player 1 controls
    if (keys['w']) movePlayer('p1', 0, -1);
    if (keys['s']) movePlayer('p1', 0, 1);
    if (keys['a']) movePlayer('p1', -1, 0);
    if (keys['d']) movePlayer('p1', 1, 0);
    
    // Player 2 controls
    if (keys['ArrowUp']) movePlayer('p2', 0, -1);
    if (keys['ArrowDown']) movePlayer('p2', 0, 1);
    if (keys['ArrowLeft']) movePlayer('p2', -1, 0);
    if (keys['ArrowRight']) movePlayer('p2', 1, 0);
    
    requestAnimationFrame(gameLoop);
  }
  
  spawnCoins();
  drawGrid();
  
  // Add movement delay
  let lastMove = 0;
  const originalMovePlayer = movePlayer;
  movePlayer = function(player, dx, dy) {
    const now = Date.now();
    if (now - lastMove > 150) { // 150ms delay between moves
      originalMovePlayer(player, dx, dy);
      lastMove = now;
    }
  };
  
  gameLoop();
  
  // Play Again functionality
  playAgainBtn.addEventListener('click', () => {
    // Reset game state
    state.p1 = { x: 0, y: 0, score: 0 };
    state.p2 = { x: 9, y: 9, score: 0 };
    state.coins = new Set();
    state.playing = true;
    
    // Hide winner message and play again button
    winnerDisplay.textContent = '';
    playAgainBtn.style.display = 'none';
    
    // Restart game
    spawnCoins();
    drawGrid();
    gameLoop();
  });
</script>
</body>
</html>
